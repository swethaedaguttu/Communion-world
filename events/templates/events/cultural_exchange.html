<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <title>Cultural Exchange</title>
    <style>
        body {
            background-color: #fff3e6;
        }
        header {
            background-color: #ff5733;
            color: white;
            text-align: center;
            padding: 50px 0;
        }
        footer {
            background-color: #ff5733;
            color: white;
            padding: 10px 0;
        }
        .card img {
            height: 200px;
            object-fit: cover;
        }
    </style>
    <script>
        // Example JavaScript for form validation or other interactivity
        function validateForm() {
            const title = document.getElementById('id_title').value;
            const description = document.getElementById('id_description').value;

            if (!title || !description) {
                alert('Please fill in all required fields.');
                return false;
            }
            return true;
        }
    </script>
</head>
<body>
    <header>
        <h1>Cultural Exchange</h1>
    </header>

    <main class="container my-5">
        <!-- Section for sharing cultural stories -->
        <h2>Share Your Culture</h2>
        <p>We invite you to share your cultural stories and traditions. Fill out the form below and tell us about your culture!</p>
        
        <form method="POST" enctype="multipart/form-data" onsubmit="return validateForm();">
            {% csrf_token %}
            <div class="form-group">
                <label for="title">Title</label>
                {{ form.title }}
            </div>
            <div class="form-group">
                <label for="description">Description</label>
                {{ form.description }}
            </div>
            <div class="form-group">
                <label for="image">Upload Image (Optional)</label>
                {{ form.image }}
            </div>
            <button type="submit" class="btn btn-primary">Submit Story</button>
        </form>

        <!-- Thank you message -->
        {% if thank_you %}
        <div class="alert alert-success my-4" role="alert">
            Thank you for sharing your culture! Your story will be reviewed and published soon.
        </div>
        {% endif %}

        <!-- Section for displaying approved cultural stories -->
        <hr>
        <h2>Cultural Stories Shared by Others</h2>
        <p>Explore the stories shared by others and learn more about diverse cultural traditions.</p>
        
        <div class="row">
            {% if request.user.is_superuser %}
                <!-- Admin can see all stories, including unapproved ones -->
                {% for story in stories %}
                    <div class="col-md-4">
                        <div class="card mb-4 shadow-sm">
                            {% if story.image %}
                                <img src="{{ story.image.url }}" class="card-img-top" alt="{{ story.title }}">
                            {% endif %}
                            <div class="card-body">
                                <h5 class="card-title">{{ story.title }}</h5>
                                <p class="card-text">{{ story.description|truncatewords:20 }}</p>
                                {% if not story.is_approved %}
                                    <p class="text-warning">Status: Pending Approval</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <!-- Regular users can only see approved stories -->
                {% for story in stories %}
                    {% if story.is_approved %}
                        <div class="col-md-4">
                            <div class="card mb-4 shadow-sm">
                                {% if story.image %}
                                    <img src="{{ story.image.url }}" class="card-img-top" alt="{{ story.title }}">
                                {% endif %}
                                <div class="card-body">
                                    <h5 class="card-title">{{ story.title }}</h5>
                                    <p class="card-text">{{ story.description|truncatewords:20 }}</p>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            {% endif %}
        </div>
    </main>

    <footer class="text-center">
        <p>&copy; 2024 Cultural Exchange</p>
    </footer>
</body>
</html>
